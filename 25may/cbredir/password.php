<?php$filename = "empty.ini";$message = "";function reset_user() {	unset($_SERVER['PHP_AUTH_USER']);	unset($_SERVER['PHP_AUTH_PW']);}function read_file() {	global $filename;	return parse_ini_file($filename);}$creds = read_file();function write_ini_file($assoc_arr, $path, $has_sections=FALSE) {    $content = "";    if ($has_sections) {        foreach ($assoc_arr as $key=>$elem) {            $content .= "[".$key."]\n";            foreach ($elem as $key2=>$elem2) {                if(is_array($elem2))                {                    for($i=0;$i<count($elem2);$i++)                    {                        $content .= $key2."[] = \"".$elem2[$i]."\"\n";                    }                }                else if($elem2=="") $content .= $key2." = \n";                else $content .= $key2." = \"".$elem2."\"\n";            }        }    }    else {        foreach ($assoc_arr as $key=>$elem) {            if(is_array($elem))            {                for($i=0;$i<count($elem);$i++)                {                    $content .= $key."[] = \"".$elem[$i]."\"\n";                }            }            else if($elem=="") $content .= $key2." = \n";            else $content .= $key." = \"".$elem."\"\n";        }    }    if (!$handle = fopen($path, 'w')) {        return false;    }    if (!fwrite($handle, $content)) {        return false;    }    fclose($handle);    return true;}function valid_creds() {	global $creds;	global $filename;  global $message;	if(array_key_exists('p', $creds)) {		//password is set		if (!isset($_POST['password'])) {      //no user saved, ask for valid credentials      if(!isset($_SESSION['password'])) {        // no session has been saved        return false;      } else if($_SESSION['password'] == $creds['p']) {        //session password matches        return true;      } else {        return false;      }		} else {      //posting back to server with password, checking credentials			if($creds['p'] == md5($_POST['password']))			{				//valid user        $_SESSION['password'] = md5($_POST['password']);				return true;			}			else			{        //invalid matching creds        $message = "Invalid Password.  Please try again.";			}		}	} else {		//password not set		if (!isset($_POST['password'])) {			//no user saved, ask for first time credentials	    return false;		} else {			//posting back to server with password, saving credentials			$data = array(		    'p' => md5($_POST['password']));			write_ini_file($data, $filename);      $_SESSION['password'] = md5($_POST['password']);			return true;		}	}	return false;}function first_time() {  global $creds;  return !array_key_exists('p', $creds);}?>